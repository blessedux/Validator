"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[200],{200:function(e,t,n){n.d(t,{U:function(){return S}});var r,a=n(4964),i=n(8232),o=n(5646),s=n.n(o),c=n(4262),l=n(742),u=n(9372),d=n(8788),f=n(4675),A=n(2702),g=n(4762),p=n(716),v=n(3754).Buffer,m=(function(){function e(){(0,f.Z)(this,e),(0,g.Z)(this,"initialized",!1),(0,g.Z)(this,"baseFee","100")}return(0,A.Z)(e,[{key:"initialize",value:function(){if(this.initialized)return!0;try{return this.initialized=!0,console.log("âœ… Stellar SDK initialized successfully"),!0}catch(e){return console.error("Failed to initialize Stellar SDK:",e),!1}}},{key:"getNetwork",value:function(){if(!this.initialized)throw Error("Stellar SDK not initialized");return p.Networks.TESTNET}},{key:"getBaseFee",value:function(){if(!this.initialized)throw Error("Stellar SDK not initialized");return this.baseFee}},{key:"isInitialized",value:function(){return this.initialized}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e})().getInstance();try{m.initialize()}catch(e){console.error("Failed to initialize Stellar SDK on module load:",e)}p.Networks.TESTNET;var h="https://sign.bigger.systems";(0,a.Z)(s().mark(function e(t,n){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){var a,i=window.open("".concat(h,"/connect"),"Sign_Window","width=360,height=700");if(!i){r(Error("Popup blocked. Please allow popups and try again."));return}var o=!1,s="",c=function c(l){if(l.origin===h){a&&clearTimeout(a);try{switch(l.data.type){case"onReady":"connect"===l.data.page&&(i.postMessage({type:"sign",xdr:t,description:n,network:"testnet"},h),a=setTimeout(function(){window.removeEventListener("message",c),i.close(),r(Error("Connection timed out. Please try again."))},3e5));break;case"onConnect":o=!0,s=l.data.message.publicKey;break;case"onSign":o&&s&&(e({signedXDR:l.data.message.signedXDR,publicKey:s}),window.removeEventListener("message",c),a&&clearTimeout(a),i.close());break;case"onCancel":window.removeEventListener("message",c),a&&clearTimeout(a),i.close(),r(Error("Operation cancelled by user"));break;case"error":window.removeEventListener("message",c),a&&clearTimeout(a),i.close(),r(Error(l.data.message||"Failed to sign transaction"))}}catch(e){window.removeEventListener("message",c),a&&clearTimeout(a),i.close(),r(e)}}};window.addEventListener("message",c);var l=setInterval(function(){i.closed&&(clearInterval(l),window.removeEventListener("message",c),a&&clearTimeout(a),o||r(Error("Operation cancelled")))},500)}));case 1:case"end":return e.stop()}},e)}));var w={generateChallengeXDR:function(e,t){var n=t||"GAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWHF",r=v.from(e).toString("base64"),a=v.from(n).toString("base64"),i=v.from("0").toString("base64"),o=v.from("AAAAAQAAAAA".concat(n).concat("DOB_VALIDATOR_AUTH").concat(r)).toString("base64");return"".concat("AAAAAgAAAAEAAAAA").concat(a).concat(i).concat("AAAAAA").concat("AAAAAAAAAA").concat(o,"AAAAAQ==")}},b="https://sign.bigger.systems",y=(0,l.Ue)()((0,u.tJ)(function(e){return{walletAddress:null,isAuthenticating:!1,authToken:null,setWalletAddress:function(t){return e({walletAddress:t})},setAuthToken:function(t){return e({authToken:t})},setIsAuthenticating:function(t){return e({isAuthenticating:t})},clearWallet:function(){return e({walletAddress:null,authToken:null,isAuthenticating:!1})}}},{name:"wallet-storage"})),T=n(5703),E=i.createElement;function S(){var e,t,n,r,o,l,u,f,A,g,p=(t=(e=y()).walletAddress,n=e.isAuthenticating,r=e.authToken,o=e.setWalletAddress,l=e.setAuthToken,u=e.setIsAuthenticating,f=e.clearWallet,{walletAddress:t,isConnected:!!t&&!!r,isAuthenticating:n,connectWallet:(A=(0,a.Z)(s().mark(function e(){var t,n,r,a,i,c,f,A;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,(0,d.J7)("temp");case 4:if(t=e.sent.challenge,n=w.generateChallengeXDR(t),r=window.open("".concat(b,"/connect"),"Sign_Window","width=360,height=700")){e.next=10;break}throw Error("Popup blocked. Please allow popups and try again.");case 10:return a=new Promise(function(e,t){var a,i=!1,o="",s=function s(c){if(c.origin===b)switch(a&&clearTimeout(a),c.data.type){case"onReady":"connect"===c.data.page&&(null==r||r.postMessage({xdr:n,description:"Please sign this challenge to authenticate with DOB Validator"},b),a=setTimeout(function(){window.removeEventListener("message",s),t(Error("Connection timed out. Please try again.")),null==r||r.close()},3e5));break;case"onConnect":i=!0,o=c.data.message.publicKey;break;case"onSign":i&&o&&(e({signedXDR:c.data.message.signedXDR,publicKey:o}),window.removeEventListener("message",s),a&&clearTimeout(a),null==r||r.close());break;case"onCancel":window.removeEventListener("message",s),a&&clearTimeout(a),t(Error("Operation cancelled by user")),null==r||r.close()}};window.addEventListener("message",s);var c=setInterval(function(){null!=r&&r.closed&&(clearInterval(c),window.removeEventListener("message",s),a&&clearTimeout(a),i||t(Error("Operation cancelled")))},500)}),e.next=13,a;case 13:return c=(i=e.sent).signedXDR,f=i.publicKey,e.next=18,(0,d.uM)(f,c,t);case 18:return A=e.sent,o(f),l(A.token),document.cookie="authToken=".concat(A.token,"; path=/; max-age=").concat(A.expiresIn,"; SameSite=Lax"),document.cookie="stellarPublicKey=".concat(f,"; path=/; max-age=").concat(A.expiresIn,"; SameSite=Lax"),e.abrupt("return",f);case 26:throw e.prev=26,e.t0=e.catch(0),console.error("Error connecting wallet:",e.t0),e.t0;case 30:return e.prev=30,u(!1),e.finish(30);case 33:case"end":return e.stop()}},e,null,[[0,26,30,33]])})),function(){return A.apply(this,arguments)}),disconnectWallet:function(){var e=window.open("".concat(b,"/logout"),"Logout_Window","width=100, height=100");window.addEventListener("message",function t(n){n.origin===b&&"onLogOut"===n.data.type&&(window.removeEventListener("message",t),null==e||e.close())}),null==e||e.postMessage({type:"logout"},b),document.cookie="authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="stellarPublicKey=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",f()}}),v=p.walletAddress,m=p.isConnected,h=p.isAuthenticating,S=p.connectWallet,k=p.disconnectWallet,x=(0,T.pm)().toast,O=(0,i.useState)(null),D=O[0],I=O[1],z=(g=(0,a.Z)(s().mark(function e(){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I(null),e.next=4,S();case 4:x({title:"Wallet Connected",description:"Your Stellar wallet has been connected successfully."}),e.next=13;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error connecting wallet:",e.t0),I(t=e.t0 instanceof Error?e.t0.message:"Failed to connect wallet"),x({title:"Connection Failed",description:t,variant:"destructive"});case 13:case"end":return e.stop()}},e,null,[[0,7]])})),function(){return g.apply(this,arguments)});return E("div",{className:"flex flex-col gap-4"},D&&E("div",{className:"text-red-500 text-sm"},D),m?E("div",{className:"flex flex-col gap-2"},E("div",{className:"text-sm text-muted-foreground"},"Connected: ",v),E(c.z,{onClick:function(){try{k(),I(null),x({title:"Wallet Disconnected",description:"Your Stellar wallet has been disconnected."})}catch(t){console.error("Error disconnecting wallet:",t);var e=t instanceof Error?t.message:"Failed to disconnect wallet";I(e),x({title:"Disconnection Failed",description:e,variant:"destructive"})}},variant:"outline",className:"w-full"},"Disconnect Wallet")):E(c.z,{onClick:z,disabled:h,className:"w-full"},h?"Connecting...":"Connect Wallet"))}},4262:function(e,t,n){n.d(t,{z:function(){return f}});var r=n(7932),a=n(6158),i=n(8232),o=n(5872),s=n(8857),c=n(9542),l=["className","variant","size","asChild"],u=i.createElement,d=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),f=i.forwardRef(function(e,t){var n=e.className,i=e.variant,s=e.size,f=e.asChild,A=(0,a.Z)(e,l);return u(void 0!==f&&f?o.g7:"button",(0,r.Z)({className:(0,c.cn)(d({variant:i,size:s,className:n})),ref:t},A))});f.displayName="Button"},5703:function(e,t,n){n.d(t,{pm:function(){return w}});var r=n(3368),a=n(3997),i=n(7932),o=n(317),s=n(4762),c=n(8232);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){(0,s.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var d=0,f=new Map,A=function(e){if(!f.has(e)){var t=setTimeout(function(){f.delete(e),m({type:"REMOVE_TOAST",toastId:e})},1e6);f.set(e,t)}},g=function(e,t){switch(t.type){case"ADD_TOAST":return u(u({},e),{},{toasts:[t.toast].concat((0,o.Z)(e.toasts)).slice(0,1)});case"UPDATE_TOAST":return u(u({},e),{},{toasts:e.toasts.map(function(e){return e.id===t.toast.id?u(u({},e),t.toast):e})});case"DISMISS_TOAST":var n=t.toastId;return n?A(n):e.toasts.forEach(function(e){A(e.id)}),u(u({},e),{},{toasts:e.toasts.map(function(e){return e.id===n||void 0===n?u(u({},e),{},{open:!1}):e})});case"REMOVE_TOAST":if(void 0===t.toastId)return u(u({},e),{},{toasts:[]});return u(u({},e),{},{toasts:e.toasts.filter(function(e){return e.id!==t.toastId})})}},p=[],v={toasts:[]};function m(e){v=g(v,e),p.forEach(function(e){e(v)})}function h(e){var t=(0,i.Z)({},((0,a.Z)(e),e)),n=(d=(d+1)%Number.MAX_SAFE_INTEGER).toString(),r=function(){return m({type:"DISMISS_TOAST",toastId:n})};return m({type:"ADD_TOAST",toast:u(u({},t),{},{id:n,open:!0,onOpenChange:function(e){e||r()}})}),{id:n,dismiss:r,update:function(e){return m({type:"UPDATE_TOAST",toast:u(u({},e),{},{id:n})})}}}function w(){var e=c.useState(v),t=(0,r.Z)(e,2),n=t[0],a=t[1];return c.useEffect(function(){return p.push(a),function(){var e=p.indexOf(a);e>-1&&p.splice(e,1)}},[n]),u(u({},n),{},{toast:h,dismiss:function(e){return m({type:"DISMISS_TOAST",toastId:e})}})}},9542:function(e,t,n){n.d(t,{cn:function(){return i}});var r=n(4947),a=n(31);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}}}]);