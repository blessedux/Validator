"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{6022:function(e,t,r){r.d(t,{E:function(){return p}});var n=r(4762),a=r(4964),s=r(4675),u=r(2702),o=r(5646),c=r.n(o);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var p=new(function(){var e,t,r,n,o,i,p,h,f,g,d;function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,s.Z)(this,v),this.baseUrl=e}return(0,u.Z)(v,[{key:"request",value:(e=(0,a.Z)(c().mark(function e(t){var r,n,a,s,u,o,i=arguments;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:{},n="".concat(this.baseUrl).concat(t),a=l({headers:l({"Content-Type":"application/json"},r.headers)},r),s=localStorage.getItem("authToken"))try{(u=JSON.parse(s)).token&&(a.headers=l(l({},a.headers),{},{Authorization:"Bearer ".concat(u.token)}))}catch(e){console.error("Failed to parse auth token:",e)}return e.prev=5,e.next=8,fetch(n,a);case 8:if((o=e.sent).ok){e.next=14;break}return e.next=12,o.json().catch(function(){return{}});case 12:throw Error(e.sent.error||"HTTP error! status: ".concat(o.status));case 14:return e.next=16,o.json();case 16:return e.abrupt("return",e.sent);case 19:throw e.prev=19,e.t0=e.catch(5),console.error("API request failed:",e.t0),e.t0;case 23:case"end":return e.stop()}},e,this,[[5,19]])})),function(t){return e.apply(this,arguments)})},{key:"generateChallenge",value:(t=(0,a.Z)(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/api/auth/challenge",{method:"POST",body:JSON.stringify({walletAddress:t})}));case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"verifySignature",value:(r=(0,a.Z)(c().mark(function e(t,r,n){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/api/auth/verify",{method:"POST",body:JSON.stringify({walletAddress:t,signature:r,challenge:n})}));case 1:case"end":return e.stop()}},e,this)})),function(e,t,n){return r.apply(this,arguments)})},{key:"getProfile",value:(n=(0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/api/profile"));case 1:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"createProfile",value:(o=(0,a.Z)(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/api/profile",{method:"POST",body:JSON.stringify(t)}));case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getSubmissions",value:(i=(0,a.Z)(c().mark(function e(t){var r,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new URLSearchParams,null!=t&&t.status&&r.append("status",t.status),null!=t&&t.limit&&r.append("limit",t.limit.toString()),null!=t&&t.offset&&r.append("offset",t.offset.toString()),n=r.toString(),a="/api/submissions".concat(n?"?".concat(n):""),e.abrupt("return",this.request(a));case 7:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"getSubmission",value:(p=(0,a.Z)(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/api/submissions/".concat(t)));case 1:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"createSubmission",value:(h=(0,a.Z)(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/api/submissions",{method:"POST",body:JSON.stringify(t)}));case 1:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"submitDevice",value:(f=(0,a.Z)(c().mark(function e(t){var r,n,a,s,u;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="".concat(this.baseUrl,"/api/submit"),n=localStorage.getItem("authToken"),a={},n)try{(s=JSON.parse(n)).token&&(a.Authorization="Bearer ".concat(s.token))}catch(e){console.error("Failed to parse auth token:",e)}return e.next=6,fetch(r,{method:"POST",headers:a,body:t});case 6:if((u=e.sent).ok){e.next=12;break}return e.next=10,u.json().catch(function(){return{}});case 10:throw Error(e.sent.error||"HTTP error! status: ".concat(u.status));case 12:return e.abrupt("return",u.json());case 13:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"updateSubmissionStatus",value:(g=(0,a.Z)(c().mark(function e(t,r,n){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/api/submissions/".concat(t,"/status"),{method:"PUT",body:JSON.stringify({status:r,adminNotes:n})}));case 1:case"end":return e.stop()}},e,this)})),function(e,t,r){return g.apply(this,arguments)})},{key:"healthCheck",value:(d=(0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("/health"));case 1:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)})}]),v}())},8788:function(e,t,r){r.d(t,{$8:function(){return p},J7:function(){return h},bW:function(){return l},uM:function(){return f}});var n,a,s=r(4964),u=r(5646),o=r.n(u),c=r(6022);r(1591);var i=r(8070);i.env.JWT_SECRET,i.env.JWT_EXPIRES_IN;var l=function(){var e=localStorage.getItem("authToken");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},p=function(){var e=l();return!!(null!=e&&e.token)},h=(n=(0,s.Z)(o().mark(function e(t){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("\uD83D\uDD0D Requesting challenge for wallet:",t),e.next=4,c.E.generateChallenge(t);case 4:return console.log("✅ Challenge received:",(r=e.sent).challenge),e.abrupt("return",{challenge:r.challenge,message:"Please sign this challenge with your wallet to authenticate"});case 9:throw e.prev=9,e.t0=e.catch(0),console.error("❌ Failed to request challenge:",e.t0),Error("Failed to request challenge");case 13:case"end":return e.stop()}},e,null,[[0,9]])})),function(e){return n.apply(this,arguments)}),f=(a=(0,s.Z)(o().mark(function e(t,r,n){var a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uD83D\uDD0D Verifying signature..."),console.log("\uD83D\uDD0D Wallet address:",t),console.log("\uD83D\uDD0D Challenge:",n),console.log("\uD83D\uDD0D Signature:",r.substring(0,20)+"..."),e.prev=4,e.next=7,c.E.verifySignature(t,r,n);case 7:return console.log("✅ Verification successful:",a=e.sent),e.abrupt("return",{token:a.token,expiresIn:"7d",walletAddress:t});case 12:throw e.prev=12,e.t0=e.catch(4),console.error("❌ Verification failed:",e.t0),Error("Failed to verify signature");case 16:case"end":return e.stop()}},e,null,[[4,12]])})),function(e,t,r){return a.apply(this,arguments)})}}]);